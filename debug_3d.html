<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3Dé—®é¢˜è¯Šæ–­</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: #1a1a1a;
            color: #fff;
            padding: 20px;
            margin: 0;
        }
        .debug-container {
            max-width: 800px;
            margin: 0 auto;
            background: #2a2a2a;
            border-radius: 10px;
            padding: 20px;
        }
        .test-section {
            margin-bottom: 20px;
            padding: 15px;
            background: #333;
            border-radius: 8px;
            border-left: 4px solid #00d4ff;
        }
        .test-btn {
            background: #00d4ff;
            color: #000;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-btn:hover {
            background: #0099cc;
        }
        #log {
            background: #000;
            color: #0f0;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            height: 200px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        #test-canvas {
            border: 2px solid #00d4ff;
            background: #000;
        }
    </style>
</head>
<body>
    <div class="debug-container">
        <h1>ğŸ”§ 3Dé—®é¢˜è¯Šæ–­å·¥å…·</h1>
        
        <div class="test-section">
            <h3>1. Three.js åº“æ£€æµ‹</h3>
            <button class="test-btn" onclick="testThreeJS()">æ£€æµ‹ Three.js</button>
            <div id="threejs-status"></div>
        </div>

        <div class="test-section">
            <h3>2. WebGL æ”¯æŒæ£€æµ‹</h3>
            <button class="test-btn" onclick="testWebGL()">æ£€æµ‹ WebGL</button>
            <div id="webgl-status"></div>
        </div>

        <div class="test-section">
            <h3>3. åŸºç¡€3Dæµ‹è¯•</h3>
            <button class="test-btn" onclick="testBasic3D()">åˆ›å»ºåŸºç¡€3Dåœºæ™¯</button>
            <canvas id="test-canvas" width="400" height="300"></canvas>
        </div>

        <div class="test-section">
            <h3>4. æ§åˆ¶å°æ—¥å¿—</h3>
            <button class="test-btn" onclick="clearLog()">æ¸…ç©ºæ—¥å¿—</button>
            <div id="log"></div>
        </div>

        <div class="test-section">
            <h3>5. é¡µé¢æµ‹è¯•</h3>
            <button class="test-btn" onclick="window.open('index_simple.html', '_blank')">æµ‹è¯•ç®€åŒ–ç‰ˆé¡µé¢</button>
            <button class="test-btn" onclick="window.open('index.html', '_blank')">æµ‹è¯•å®Œæ•´ç‰ˆé¡µé¢</button>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        // é‡å†™console.logæ¥æ˜¾ç¤ºåœ¨é¡µé¢ä¸Š
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;
        
        function addToLog(message, type = 'log') {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'error' ? '#f00' : type === 'warn' ? '#fa0' : '#0f0';
            logDiv.innerHTML += `<span style="color: ${color}">[${timestamp}] ${type.toUpperCase()}: ${message}</span>\n`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addToLog(args.join(' '), 'log');
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addToLog(args.join(' '), 'error');
        };
        
        console.warn = function(...args) {
            originalWarn.apply(console, args);
            addToLog(args.join(' '), 'warn');
        };

        function clearLog() {
            document.getElementById('log').innerHTML = '';
        }

        function testThreeJS() {
            const statusDiv = document.getElementById('threejs-status');
            if (typeof THREE !== 'undefined') {
                statusDiv.innerHTML = `<span style="color: #0f0">âœ“ Three.js å·²åŠ è½½ï¼Œç‰ˆæœ¬: ${THREE.REVISION}</span>`;
                console.log('Three.js æ£€æµ‹é€šè¿‡');
            } else {
                statusDiv.innerHTML = `<span style="color: #f00">âœ— Three.js æœªåŠ è½½</span>`;
                console.error('Three.js æœªåŠ è½½');
            }
        }

        function testWebGL() {
            const statusDiv = document.getElementById('webgl-status');
            const canvas = document.createElement('canvas');
            const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
            
            if (gl) {
                const info = {
                    vendor: gl.getParameter(gl.VENDOR),
                    renderer: gl.getParameter(gl.RENDERER),
                    version: gl.getParameter(gl.VERSION)
                };
                statusDiv.innerHTML = `
                    <span style="color: #0f0">âœ“ WebGL æ”¯æŒ</span><br>
                    <small>ä¾›åº”å•†: ${info.vendor}<br>
                    æ¸²æŸ“å™¨: ${info.renderer}<br>
                    ç‰ˆæœ¬: ${info.version}</small>
                `;
                console.log('WebGL æ£€æµ‹é€šè¿‡', info);
            } else {
                statusDiv.innerHTML = `<span style="color: #f00">âœ— WebGL ä¸æ”¯æŒ</span>`;
                console.error('WebGL ä¸æ”¯æŒ');
            }
        }

        function testBasic3D() {
            console.log('å¼€å§‹åŸºç¡€3Dæµ‹è¯•...');
            
            try {
                const canvas = document.getElementById('test-canvas');
                const scene = new THREE.Scene();
                scene.background = new THREE.Color(0x87CEEB);
                
                const camera = new THREE.PerspectiveCamera(75, canvas.width / canvas.height, 0.1, 1000);
                camera.position.z = 5;
                
                const renderer = new THREE.WebGLRenderer({ canvas: canvas });
                renderer.setSize(canvas.width, canvas.height);
                
                // åˆ›å»ºä¸€ä¸ªç®€å•çš„ç«‹æ–¹ä½“
                const geometry = new THREE.BoxGeometry();
                const material = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
                const cube = new THREE.Mesh(geometry, material);
                scene.add(cube);
                
                // æ¸²æŸ“
                function animate() {
                    requestAnimationFrame(animate);
                    cube.rotation.x += 0.01;
                    cube.rotation.y += 0.01;
                    renderer.render(scene, camera);
                }
                
                animate();
                console.log('åŸºç¡€3Dåœºæ™¯åˆ›å»ºæˆåŠŸ');
                
            } catch (error) {
                console.error('åŸºç¡€3Dæµ‹è¯•å¤±è´¥:', error);
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨è¿è¡Œæ£€æµ‹
        window.addEventListener('load', function() {
            console.log('é¡µé¢åŠ è½½å®Œæˆï¼Œå¼€å§‹è‡ªåŠ¨æ£€æµ‹...');
            setTimeout(() => {
                testThreeJS();
                testWebGL();
            }, 1000);
        });
    </script>
</body>
</html>