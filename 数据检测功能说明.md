# 沙漠铺设设备云平台 - 动态数据检测功能

## 功能概述

为沙漠铺设设备云平台添加了全新的动态数据检测功能，包含多种类型的实时图表和数据可视化，让用户能够实时监控设备状态、环境参数、生产进度等关键指标。

## 新增功能特性

### 1. 动态数据管理系统
- **实时数据更新**: 每2秒自动更新一次数据
- **模拟数据库**: 使用JSON文件存储各类监测数据
- **数据订阅机制**: 支持多个组件订阅同一数据源
- **智能数据生成**: 基于真实场景的数据变化模拟

### 2. 多类型图表展示

#### 环境监测图表
- **类型**: 多参数折线图
- **监测参数**: 温度、湿度、风速、沙密度、能见度
- **特点**: 实时更新，显示当前值和平均值对比
- **数据范围**: 
  - 温度: 20-45°C
  - 湿度: 30-70%
  - 风速: 0-25km/h
  - 沙密度: 1.5-2.2g/cm³
  - 能见度: 0-15km

#### 生产数据统计图表
- **类型**: 双轴柱状图
- **监测指标**: 草方格数量、铺设面积
- **时间维度**: 按周统计显示
- **特点**: 支持切换产量/效率视图

#### 质量指标监测图表
- **类型**: 环形图(Doughnut Chart)
- **质量指标**: 
  - 固沙效果: 95%
  - 网格均匀性: 88%
  - 材料利用率: 92%
  - 耐久性: 87%
- **特点**: 直观显示各项质量指标占比

#### 系统警报统计图表
- **类型**: 饼图(Pie Chart)
- **警报分类**: 正常、警告、严重
- **特点**: 实时统计系统状态分布

### 3. 增强的现有图表

#### 材料库存图表
- **优化**: 添加动态库存变化
- **材料类型**: 麦草、稻草、芦苇、固定桩、铁丝网
- **特点**: 库存量实时更新，支持时间段切换

#### 风速监测图表
- **优化**: 与环境数据联动更新
- **特点**: 24小时历史数据滚动显示

#### 设备效率分析图表
- **优化**: 雷达图显示多维度效率
- **维度**: 工作效率、设备利用率
- **特点**: 6台设备的综合效率对比

#### 设备位置导航图表
- **优化**: 实时更新设备GPS坐标
- **特点**: 设备位置动态变化，支持设备定位

### 4. 智能数据模拟

#### 环境数据模拟
- **温度变化**: 基于时间和天气模式的自然波动
- **湿度变化**: 与温度相关联的合理变化
- **风速变化**: 模拟沙漠地区风力变化特征
- **沙密度**: 根据作业进度动态调整
- **能见度**: 受风速和沙尘影响的变化

#### 设备状态模拟
- **电池/燃油消耗**: 基于工作时间的合理消耗
- **效率波动**: 模拟设备性能的正常波动
- **位置移动**: GPS坐标的微小变化模拟设备移动
- **状态切换**: 根据电量/燃油自动切换设备状态

#### 生产数据模拟
- **进度累积**: 每日生产数据的累积增长
- **效率变化**: 基于设备状态和环境条件的效率变化
- **质量指标**: 随机波动但保持在合理范围内

#### 警报系统模拟
- **随机警报生成**: 10%概率生成新警报
- **警报分级**: 自动分配严重程度(高/中/低)
- **警报类型**: 设备、天气、电池、系统等多种类型

## 技术实现

### 数据管理架构
```
DataManager (数据管理器)
├── 数据加载 (JSON文件/模拟数据)
├── 实时更新 (定时器机制)
├── 订阅系统 (观察者模式)
└── 数据分发 (通知各图表组件)
```

### 图表更新机制
```
数据更新流程:
数据管理器 → 数据变化 → 通知订阅者 → 更新图表 → 动画效果
```

### 文件结构
```
├── data/
│   └── monitoring-data.json     # 模拟数据库文件
├── js/
│   └── data-manager.js          # 数据管理器
├── dashboard.html               # 主监控面板
├── dashboard.js                 # 图表逻辑(已增强)
├── dashboard.css                # 样式文件(已增强)
└── test-data.html              # 数据测试页面
```

## 使用说明

### 1. 访问数据检测页面
- 打开主页面 `index.html`
- 点击"数据检测"或直接访问 `dashboard.html`

### 2. 实时数据监控
- 页面加载后自动开始数据更新
- 所有图表每2秒刷新一次
- 指标卡片实时显示最新数值

### 3. 交互功能
- **时间段切换**: 点击"日/周/月"按钮切换数据视图
- **图表类型切换**: 在生产数据中切换"产量/效率"视图
- **设备定位**: 点击导航区域的"定位设备"按钮
- **日志筛选**: 使用日志级别下拉菜单筛选显示内容

### 4. 数据特点
- **真实性**: 数据变化符合实际工作场景
- **连续性**: 历史数据保持连贯性
- **合理性**: 所有数值都在合理范围内波动
- **关联性**: 不同数据之间存在逻辑关联

## 视觉效果

### 动画特效
- **图表加载**: 渐入动画效果
- **数据更新**: 数值变化时的高亮效果
- **状态指示**: 设备状态指示灯的脉冲动画
- **按钮交互**: 悬停和点击的动画反馈

### 颜色方案
- **正常状态**: 绿色系 (#00ff88)
- **警告状态**: 黄色系 (#ffaa00)
- **错误状态**: 红色系 (#ff4444)
- **主题色**: 蓝色系 (#00d4ff)

## 性能优化

- **图表更新**: 使用 `update('none')` 避免重绘动画
- **数据限制**: 历史数据限制在合理范围内
- **内存管理**: 定期清理过期数据
- **响应式设计**: 适配不同屏幕尺寸

## 扩展性

系统设计支持轻松扩展:
- 添加新的数据类型
- 增加新的图表类型
- 集成真实的数据源
- 添加数据导出功能

## 测试验证

可以通过 `test-data.html` 页面验证:
- 数据管理器是否正常工作
- 数据更新机制是否有效
- 各种数据类型是否正确显示
- 实时更新功能是否稳定
